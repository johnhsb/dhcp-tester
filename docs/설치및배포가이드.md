# DHCP ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì†”ë£¨ì…˜ ì„¤ì¹˜ ë° ë°°í¬ ê°€ì´ë“œ

## ğŸ“‹ ëª©ì°¨
1. [ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­](#1-ì‹œìŠ¤í…œ-ìš”êµ¬ì‚¬í•­)
2. [ì„¤ì¹˜ ë°©ë²•](#2-ì„¤ì¹˜-ë°©ë²•)
3. [ë°°í¬ ì‹œë‚˜ë¦¬ì˜¤](#3-ë°°í¬-ì‹œë‚˜ë¦¬ì˜¤)
4. [í™˜ê²½ë³„ ì„¤ì •](#4-í™˜ê²½ë³„-ì„¤ì •)
5. [ìë™í™” ìŠ¤í¬ë¦½íŠ¸](#5-ìë™í™”-ìŠ¤í¬ë¦½íŠ¸)
6. [ì»¨í…Œì´ë„ˆ ë°°í¬](#6-ì»¨í…Œì´ë„ˆ-ë°°í¬)
7. [ëª¨ë‹ˆí„°ë§ ì„¤ì •](#7-ëª¨ë‹ˆí„°ë§-ì„¤ì •)

## 1. ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

### 1.1 í•˜ë“œì›¨ì–´ ìš”êµ¬ì‚¬í•­

#### ìµœì†Œ ìš”êµ¬ì‚¬í•­
- **CPU**: 2ì½”ì–´ ì´ìƒ
- **ë©”ëª¨ë¦¬**: 4GB RAM
- **ë””ìŠ¤í¬**: 1GB ì—¬ìœ  ê³µê°„
- **ë„¤íŠ¸ì›Œí¬**: 100Mbps ì´ìƒ

#### ê¶Œì¥ ìš”êµ¬ì‚¬í•­
- **CPU**: 8ì½”ì–´ ì´ìƒ (ëŒ€ëŸ‰ í…ŒìŠ¤íŠ¸ìš©)
- **ë©”ëª¨ë¦¬**: 16GB RAM (10,000+ í´ë¼ì´ì–¸íŠ¸)
- **ë””ìŠ¤í¬**: 10GB ì—¬ìœ  ê³µê°„ (ë¡œê·¸ ì €ì¥ìš©)
- **ë„¤íŠ¸ì›Œí¬**: 1Gbps ì´ìƒ

#### ëŒ€ê·œëª¨ í™˜ê²½ (100,000+ í´ë¼ì´ì–¸íŠ¸)
- **CPU**: 16ì½”ì–´ ì´ìƒ
- **ë©”ëª¨ë¦¬**: 32GB RAM ì´ìƒ
- **ë””ìŠ¤í¬**: SSD ê¶Œì¥
- **ë„¤íŠ¸ì›Œí¬**: 10Gbps ì´ìƒ

### 1.2 ì†Œí”„íŠ¸ì›¨ì–´ ìš”êµ¬ì‚¬í•­

#### í•„ìˆ˜ ì†Œí”„íŠ¸ì›¨ì–´
- **Go**: 1.16 ì´ìƒ (ì»´íŒŒì¼ìš©)
- **ìš´ì˜ì²´ì œ**: 
  - Linux (Ubuntu 18.04+, CentOS 7+, RHEL 7+)
  - macOS 10.14+
  - Windows 10+

#### ì„ íƒì  ì†Œí”„íŠ¸ì›¨ì–´
- **Docker**: ì»¨í…Œì´ë„ˆ ë°°í¬ìš©
- **Git**: ì†ŒìŠ¤ì½”ë“œ ê´€ë¦¬ìš©
- **Make**: ë¹Œë“œ ìë™í™”ìš©
- **Wireshark**: íŒ¨í‚· ë¶„ì„ìš©

### 1.3 ë„¤íŠ¸ì›Œí¬ ìš”êµ¬ì‚¬í•­

#### í¬íŠ¸ ì‚¬ìš©
- **UDP 67**: DHCP ì„œë²„ í¬íŠ¸
- **UDP 68**: DHCP í´ë¼ì´ì–¸íŠ¸ í¬íŠ¸
- **TCP 6060**: í”„ë¡œíŒŒì¼ë§ í¬íŠ¸ (ì„ íƒì )

#### ë°©í™”ë²½ ì„¤ì •
```bash
# Ubuntu/Debian
sudo ufw allow 67/udp
sudo ufw allow 68/udp

# CentOS/RHEL
sudo firewall-cmd --add-port=67/udp --permanent
sudo firewall-cmd --add-port=68/udp --permanent
sudo firewall-cmd --reload
```

## 2. ì„¤ì¹˜ ë°©ë²•

### 2.1 ì†ŒìŠ¤ì½”ë“œ ì»´íŒŒì¼

#### ê¸°ë³¸ ì„¤ì¹˜
```bash
# 1. Go ì„¤ì¹˜ í™•ì¸
go version

# 2. ì†ŒìŠ¤ì½”ë“œ ë‹¤ìš´ë¡œë“œ
git clone <repository-url>
cd dhcp-performance-test-suite

# 3. ì»´íŒŒì¼
go build -o dhcp-tester dhcp-tester.go
go build -o dhcp-server dhcp-server.go

# 4. ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
chmod +x dhcp-tester dhcp-server

# 5. ì„¤ì¹˜ í™•ì¸
./dhcp-tester -h
./dhcp-server -h
```

#### ìµœì í™” ë¹Œë“œ
```bash
# ì„±ëŠ¥ ìµœì í™” ë¹Œë“œ
go build -ldflags="-s -w" -gcflags="-N -l" -o dhcp-tester-opt dhcp-tester.go
go build -ldflags="-s -w" -gcflags="-N -l" -o dhcp-server-opt dhcp-server.go

# ì •ì  ë§í‚¹ ë¹Œë“œ (ë°°í¬ìš©)
CGO_ENABLED=0 GOOS=linux go build -a -ldflags="-s -w" -o dhcp-tester-static dhcp-tester.go
CGO_ENABLED=0 GOOS=linux go build -a -ldflags="-s -w" -o dhcp-server-static dhcp-server.go
```

### 2.2 í¬ë¡œìŠ¤ í”Œë«í¼ ë¹Œë“œ

```bash
# Linux 64ë¹„íŠ¸
GOOS=linux GOARCH=amd64 go build -o dhcp-tester-linux-amd64 dhcp-tester.go
GOOS=linux GOARCH=amd64 go build -o dhcp-server-linux-amd64 dhcp-server.go

# Windows 64ë¹„íŠ¸
GOOS=windows GOARCH=amd64 go build -o dhcp-tester-windows-amd64.exe dhcp-tester.go
GOOS=windows GOARCH=amd64 go build -o dhcp-server-windows-amd64.exe dhcp-server.go

# macOS 64ë¹„íŠ¸
GOOS=darwin GOARCH=amd64 go build -o dhcp-tester-darwin-amd64 dhcp-tester.go
GOOS=darwin GOARCH=amd64 go build -o dhcp-server-darwin-amd64 dhcp-server.go

# ARM64 (Apple Silicon)
GOOS=darwin GOARCH=arm64 go build -o dhcp-tester-darwin-arm64 dhcp-tester.go
GOOS=darwin GOARCH=arm64 go build -o dhcp-server-darwin-arm64 dhcp-server.go
```

### 2.3 íŒ¨í‚¤ì§€ ê´€ë¦¬ì ì„¤ì¹˜

#### Makefile ìƒì„±
```makefile
# Makefile
.PHONY: build install clean test

BINARY_CLIENT=dhcp-tester
BINARY_SERVER=dhcp-server
INSTALL_PATH=/usr/local/bin

build:
	go build -ldflags="-s -w" -o $(BINARY_CLIENT) dhcp-tester.go
	go build -ldflags="-s -w" -o $(BINARY_SERVER) dhcp-server.go

build-all:
	GOOS=linux GOARCH=amd64 go build -ldflags="-s -w" -o $(BINARY_CLIENT)-linux-amd64 dhcp-tester.go
	GOOS=linux GOARCH=amd64 go build -ldflags="-s -w" -o $(BINARY_SERVER)-linux-amd64 dhcp-server.go
	GOOS=windows GOARCH=amd64 go build -ldflags="-s -w" -o $(BINARY_CLIENT)-windows-amd64.exe dhcp-tester.go
	GOOS=windows GOARCH=amd64 go build -ldflags="-s -w" -o $(BINARY_SERVER)-windows-amd64.exe dhcp-server.go
	GOOS=darwin GOARCH=amd64 go build -ldflags="-s -w" -o $(BINARY_CLIENT)-darwin-amd64 dhcp-tester.go
	GOOS=darwin GOARCH=amd64 go build -ldflags="-s -w" -o $(BINARY_SERVER)-darwin-amd64 dhcp-server.go

install: build
	sudo cp $(BINARY_CLIENT) $(INSTALL_PATH)/
	sudo cp $(BINARY_SERVER) $(INSTALL_PATH)/
	sudo chmod +x $(INSTALL_PATH)/$(BINARY_CLIENT)
	sudo chmod +x $(INSTALL_PATH)/$(BINARY_SERVER)

uninstall:
	sudo rm -f $(INSTALL_PATH)/$(BINARY_CLIENT)
	sudo rm -f $(INSTALL_PATH)/$(BINARY_SERVER)

clean:
	rm -f $(BINARY_CLIENT)* $(BINARY_SERVER)*
	rm -f *.log *.pcap

test:
	go test -v ./...

benchmark:
	go test -bench=. -benchmem

.DEFAULT_GOAL := build
```

## 3. ë°°í¬ ì‹œë‚˜ë¦¬ì˜¤

### 3.1 ë‹¨ì¼ ì„œë²„ ë°°í¬

#### ë¡œì»¬ í…ŒìŠ¤íŠ¸ í™˜ê²½
```bash
#!/bin/bash
# deploy-local.sh

echo "=== DHCP í…ŒìŠ¤íŠ¸ í™˜ê²½ ë¡œì»¬ ë°°í¬ ==="

# 1. ë¹Œë“œ
make build

# 2. ì„¤ì • íŒŒì¼ ìƒì„±
cat > dhcp-server.conf << EOF
listen-ip=0.0.0.0
port=67
start-ip=192.168.100.10
end-ip=192.168.100.250
gateway=192.168.100.1
dns1=8.8.8.8
dns2=8.8.4.4
lease-time=24h
EOF

cat > dhcp-tester.conf << EOF
server=127.0.0.1
port=67
clients=1000
concurrency=100
timeout=30s
retry=true
max-discover-retries=3
max-request-retries=3
EOF

# 3. ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
cat > run-server.sh << 'EOF'
#!/bin/bash
./dhcp-server -live -verbose \
  -start-ip 192.168.100.10 \
  -end-ip 192.168.100.250 \
  -gateway 192.168.100.1 \
  -dns1 8.8.8.8 \
  -dns2 8.8.4.4 \
  -lease-time 24h
EOF

cat > run-tester.sh << 'EOF'
#!/bin/bash
./dhcp-tester -server 127.0.0.1 \
  -clients 1000 -concurrency 100 \
  -retry -max-discover-retries 3 -max-request-retries 3 \
  -live -timeout 30s
EOF

chmod +x run-server.sh run-tester.sh

echo "ë°°í¬ ì™„ë£Œ!"
echo "ì„œë²„ ì‹œì‘: ./run-server.sh"
echo "í…ŒìŠ¤í„° ì‹¤í–‰: ./run-tester.sh"
```

### 3.2 ë¶„ì‚° ë°°í¬

#### ë‹¤ì¤‘ ì„œë²„ í™˜ê²½
```bash
#!/bin/bash
# deploy-distributed.sh

SERVERS=("server1.example.com" "server2.example.com" "server3.example.com")
BINARY_PATH="./dhcp-tester-linux-amd64"

echo "=== ë¶„ì‚° DHCP í…ŒìŠ¤íŠ¸ ë°°í¬ ==="

# 1. ë°”ì´ë„ˆë¦¬ ë¹Œë“œ
make build-all

# 2. ê° ì„œë²„ì— ë°°í¬
for server in "${SERVERS[@]}"; do
    echo "ì„œë²„ ë°°í¬: $server"
    
    # ë°”ì´ë„ˆë¦¬ ë³µì‚¬
    scp $BINARY_PATH $server:/tmp/dhcp-tester
    
    # ì›ê²© ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ ë°°í¬
    ssh $server << 'EOF'
        # ë””ë ‰í† ë¦¬ ìƒì„±
        mkdir -p /opt/dhcp-test
        chmod 755 /opt/dhcp-test
        
        # ë°”ì´ë„ˆë¦¬ ì´ë™
        sudo mv /tmp/dhcp-tester /opt/dhcp-test/
        sudo chmod +x /opt/dhcp-test/dhcp-tester
        
        # systemd ì„œë¹„ìŠ¤ ìƒì„±
        sudo cat > /etc/systemd/system/dhcp-tester.service << 'EOL'
[Unit]
Description=DHCP Performance Tester
After=network.target

[Service]
Type=simple
User=dhcp-test
ExecStart=/opt/dhcp-test/dhcp-tester -server 192.168.1.1 -clients 5000 -concurrency 200 -live
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target
EOL

        # ì„œë¹„ìŠ¤ í™œì„±í™”
        sudo systemctl daemon-reload
        sudo systemctl enable dhcp-tester
EOL

    echo "ì„œë²„ $server ë°°í¬ ì™„ë£Œ"
done

echo "ë¶„ì‚° ë°°í¬ ì™„ë£Œ!"
```

### 3.3 í´ë¼ìš°ë“œ ë°°í¬

#### AWS ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
```bash
#!/bin/bash
# deploy-aws.sh

# AWS CLI ì„¤ì • í™•ì¸
if ! command -v aws &> /dev/null; then
    echo "AWS CLIê°€ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."
    exit 1
fi

# ë³€ìˆ˜ ì„¤ì •
REGION="ap-northeast-2"
KEY_PAIR="dhcp-test-key"
SECURITY_GROUP="dhcp-test-sg"
INSTANCE_TYPE="c5.2xlarge"
AMI_ID="ami-0c9c942bd7bf113a2"  # Ubuntu 20.04 LTS

echo "=== AWS EC2 ì¸ìŠ¤í„´ìŠ¤ ë°°í¬ ==="

# 1. ë³´ì•ˆ ê·¸ë£¹ ìƒì„±
aws ec2 create-security-group \
    --group-name $SECURITY_GROUP \
    --description "DHCP Test Security Group" \
    --region $REGION

# DHCP í¬íŠ¸ í—ˆìš©
aws ec2 authorize-security-group-ingress \
    --group-name $SECURITY_GROUP \
    --protocol udp \
    --port 67 \
    --cidr 0.0.0.0/0 \
    --region $REGION

aws ec2 authorize-security-group-ingress \
    --group-name $SECURITY_GROUP \
    --protocol udp \
    --port 68 \
    --cidr 0.0.0.0/0 \
    --region $REGION

# SSH í¬íŠ¸ í—ˆìš©
aws ec2 authorize-security-group-ingress \
    --group-name $SECURITY_GROUP \
    --protocol tcp \
    --port 22 \
    --cidr 0.0.0.0/0 \
    --region $REGION

# 2. ì‚¬ìš©ì ë°ì´í„° ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
cat > user-data.sh << 'EOF'
#!/bin/bash
apt-get update
apt-get install -y golang-go git make

# ì‚¬ìš©ì ìƒì„±
useradd -m -s /bin/bash dhcp-test
mkdir -p /home/dhcp-test/dhcp-suite
chown dhcp-test:dhcp-test /home/dhcp-test/dhcp-suite

# ì†ŒìŠ¤ì½”ë“œ ë‹¤ìš´ë¡œë“œ ë° ë¹Œë“œ
cd /home/dhcp-test/dhcp-suite
git clone <repository-url> .
go build -o dhcp-tester dhcp-tester.go
go build -o dhcp-server dhcp-server.go
chown -R dhcp-test:dhcp-test /home/dhcp-test/

# ë°©í™”ë²½ ì„¤ì •
ufw allow 67/udp
ufw allow 68/udp
ufw --force enable
EOF

# 3. EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
INSTANCE_ID=$(aws ec2 run-instances \
    --image-id $AMI_ID \
    --count 1 \
    --instance-type $INSTANCE_TYPE \
    --key-name $KEY_PAIR \
    --security-groups $SECURITY_GROUP \
    --user-data file://user-data.sh \
    --region $REGION \
    --query 'Instances[0].InstanceId' \
    --output text)

echo "EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„±ë¨: $INSTANCE_ID"

# 4. ì¸ìŠ¤í„´ìŠ¤ ìƒíƒœ í™•ì¸
echo "ì¸ìŠ¤í„´ìŠ¤ ì‹œì‘ ëŒ€ê¸° ì¤‘..."
aws ec2 wait instance-running --instance-ids $INSTANCE_ID --region $REGION

# 5. í¼ë¸”ë¦­ IP ì¡°íšŒ
PUBLIC_IP=$(aws ec2 describe-instances \
    --instance-ids $INSTANCE_ID \
    --region $REGION \
    --query 'Reservations[0].Instances[0].PublicIpAddress' \
    --output text)

echo "=== ë°°í¬ ì™„ë£Œ ==="
echo "ì¸ìŠ¤í„´ìŠ¤ ID: $INSTANCE_ID"
echo "í¼ë¸”ë¦­ IP: $PUBLIC_IP"
echo "SSH ì ‘ì†: ssh -i $KEY_PAIR.pem ubuntu@$PUBLIC_IP"

# ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
cat > cleanup-aws.sh << EOF
#!/bin/bash
echo "AWS ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì¤‘..."
aws ec2 terminate-instances --instance-ids $INSTANCE_ID --region $REGION
aws ec2 wait instance-terminated --instance-ids $INSTANCE_ID --region $REGION
aws ec2 delete-security-group --group-name $SECURITY_GROUP --region $REGION
echo "ì •ë¦¬ ì™„ë£Œ"
EOF

chmod +x cleanup-aws.sh
```

## 4. í™˜ê²½ë³„ ì„¤ì •

### 4.1 ê°œë°œ í™˜ê²½

#### ê°œë°œìš© ì„¤ì • íŒŒì¼
```yaml
# config/development.yaml
server:
  listen_ip: "127.0.0.1"
  port: 6700  # í‘œì¤€ í¬íŠ¸ ì¶©ëŒ ë°©ì§€
  ip_pool:
    start: "10.0.100.10"
    end: "10.0.100.50"
  lease_time: "1h"
  
client:
  server_ip: "127.0.0.1"
  server_port: 6700
  test_size: 100
  concurrency: 10
  timeout: "10s"
  
logging:
  level: "debug"
  verbose: true
  live_stats: true
```

#### ê°œë°œ í™˜ê²½ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
```bash
#!/bin/bash
# scripts/dev-run.sh

# ê°œë°œ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
export DHCP_ENV="development"
export DHCP_LOG_LEVEL="debug"

# ì„œë²„ ì‹œì‘ (ë°±ê·¸ë¼ìš´ë“œ)
./dhcp-server -port 6700 \
  -start-ip 10.0.100.10 \
  -end-ip 10.0.100.50 \
  -lease-time 1h \
  -verbose -live &

SERVER_PID=$!
echo "DHCP ì„œë²„ ì‹œì‘ë¨ (PID: $SERVER_PID)"

# ì ì‹œ ëŒ€ê¸°
sleep 3

# í…ŒìŠ¤í„° ì‹¤í–‰
./dhcp-tester -server 127.0.0.1 -port 6700 \
  -clients 100 -concurrency 10 \
  -timeout 10s -verbose

# ì„œë²„ ì¢…ë£Œ
kill $SERVER_PID
echo "í…ŒìŠ¤íŠ¸ ì™„ë£Œ"
```

### 4.2 ìŠ¤í…Œì´ì§• í™˜ê²½

#### ìŠ¤í…Œì´ì§•ìš© ì„¤ì •
```bash
#!/bin/bash
# scripts/staging-setup.sh

# í™˜ê²½ ë³€ìˆ˜
export DHCP_ENV="staging"
export DHCP_SERVER_IP="192.168.200.1"
export DHCP_POOL_START="192.168.200.100"
export DHCP_POOL_END="192.168.200.200"

# ë¡œê·¸ ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p /var/log/dhcp-test
chown dhcp-test:dhcp-test /var/log/dhcp-test

# systemd ì„œë¹„ìŠ¤ íŒŒì¼ ìƒì„±
cat > /etc/systemd/system/dhcp-test-server.service << EOF
[Unit]
Description=DHCP Test Server (Staging)
After=network.target

[Service]
Type=simple
User=dhcp-test
WorkingDirectory=/opt/dhcp-test
ExecStart=/opt/dhcp-test/dhcp-server \\
  -listen $DHCP_SERVER_IP \\
  -port 67 \\
  -start-ip $DHCP_POOL_START \\
  -end-ip $DHCP_POOL_END \\
  -lease-time 2h \\
  -max-concurrent 2000 \\
  -response-delay 10ms \\
  -verbose
ExecReload=/bin/kill -HUP \$MAINPID
KillMode=process
Restart=always
RestartSec=5
StandardOutput=append:/var/log/dhcp-test/server.log
StandardError=append:/var/log/dhcp-test/server-error.log

[Install]
WantedBy=multi-user.target
EOF

# ì„œë¹„ìŠ¤ í™œì„±í™”
systemctl daemon-reload
systemctl enable dhcp-test-server
systemctl start dhcp-test-server

echo "ìŠ¤í…Œì´ì§• í™˜ê²½ ì„¤ì • ì™„ë£Œ"
```

### 4.3 ìš´ì˜ í™˜ê²½

#### ìš´ì˜ìš© ì„¤ì •
```bash
#!/bin/bash
# scripts/production-setup.sh

# ë³´ì•ˆ ì„¤ì •
umask 027

# ì „ìš© ì‚¬ìš©ì ìƒì„±
if ! id "dhcp-prod" &>/dev/null; then
    useradd -r -s /bin/false -d /opt/dhcp-prod dhcp-prod
fi

# ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±
mkdir -p /opt/dhcp-prod/{bin,config,logs,data}
mkdir -p /etc/dhcp-test

# ì„¤ì • íŒŒì¼ ìƒì„±
cat > /etc/dhcp-test/production.conf << EOF
# DHCP Production Configuration
DHCP_LISTEN_IP=0.0.0.0
DHCP_PORT=67
DHCP_START_IP=172.16.1.100
DHCP_END_IP=172.16.10.250
DHCP_GATEWAY=172.16.1.1
DHCP_DNS1=172.16.1.10
DHCP_DNS2=8.8.8.8
DHCP_LEASE_TIME=24h
DHCP_MAX_CONCURRENT=5000
DHCP_RESPONSE_DELAY=0ms
DHCP_DROP_RATE=0.0
LOG_LEVEL=info
ENABLE_RELAY=true
MAX_HOPS=4
EOF

# systemd ì„œë¹„ìŠ¤ íŒŒì¼ (ìš´ì˜ìš©)
cat > /etc/systemd/system/dhcp-prod-server.service << EOF
[Unit]
Description=DHCP Production Server
After=network.target
Wants=network.target

[Service]
Type=simple
User=dhcp-prod
Group=dhcp-prod
WorkingDirectory=/opt/dhcp-prod
EnvironmentFile=/etc/dhcp-test/production.conf
ExecStart=/opt/dhcp-prod/bin/dhcp-server \\
  -listen \${DHCP_LISTEN_IP} \\
  -port \${DHCP_PORT} \\
  -start-ip \${DHCP_START_IP} \\
  -end-ip \${DHCP_END_IP} \\
  -gateway \${DHCP_GATEWAY} \\
  -dns1 \${DHCP_DNS1} \\
  -dns2 \${DHCP_DNS2} \\
  -lease-time \${DHCP_LEASE_TIME} \\
  -max-concurrent \${DHCP_MAX_CONCURRENT} \\
  -response-delay \${DHCP_RESPONSE_DELAY} \\
  -drop-rate \${DHCP_DROP_RATE} \\
  -relay=\${ENABLE_RELAY} \\
  -max-hops \${MAX_HOPS}

# ë³´ì•ˆ ì„¤ì •
NoNewPrivileges=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/opt/dhcp-prod/logs /opt/dhcp-prod/data
PrivateTmp=true
ProtectKernelTunables=true
ProtectControlGroups=true
RestrictSUIDSGID=true

# ë¦¬ì†ŒìŠ¤ ì œí•œ
LimitNOFILE=65536
LimitNPROC=4096

# ì¬ì‹œì‘ ì •ì±…
Restart=always
RestartSec=10
TimeoutStopSec=30

# ë¡œê¹…
StandardOutput=append:/opt/dhcp-prod/logs/server.log
StandardError=append:/opt/dhcp-prod/logs/server-error.log
SyslogIdentifier=dhcp-prod-server

[Install]
WantedBy=multi-user.target
EOF

# ë¡œê·¸ ë¡œí…Œì´ì…˜ ì„¤ì •
cat > /etc/logrotate.d/dhcp-prod << EOF
/opt/dhcp-prod/logs/*.log {
    daily
    rotate 30
    compress
    delaycompress
    missingok
    notifempty
    copytruncate
    su dhcp-prod dhcp-prod
}
EOF

# ê¶Œí•œ ì„¤ì •
chown -R dhcp-prod:dhcp-prod /opt/dhcp-prod
chmod 750 /opt/dhcp-prod
chmod 640 /etc/dhcp-test/production.conf

echo "ìš´ì˜ í™˜ê²½ ì„¤ì • ì™„ë£Œ"
```

## 5. ìë™í™” ìŠ¤í¬ë¦½íŠ¸

### 5.1 CI/CD íŒŒì´í”„ë¼ì¸

#### GitHub Actions
```yaml
# .github/workflows/build-and-test.yml
name: Build and Test

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Go
      uses: actions/setup-go@v3
      with:
        go-version: 1.19
    
    - name: Cache Go modules
      uses: actions/cache@v3
      with:
        path: ~/go/pkg/mod
        key: ${{ runner.os }}-go-${{ hashFiles('**/go.sum') }}
        restore-keys: |
          ${{ runner.os }}-go-
    
    - name: Run tests
      run: |
        go test -v ./...
        go test -race -coverprofile=coverage.out ./...
    
    - name: Run benchmarks
      run: go test -bench=. -benchmem ./...
    
    - name: Build binaries
      run: |
        make build-all
    
    - name: Upload artifacts
      uses: actions/upload-artifact@v3
      with:
        name: dhcp-test-binaries
        path: |
          dhcp-*-*
          !dhcp-*.go

  release:
    needs: test
    runs-on: ubuntu-latest
    if: startsWith(github.ref, 'refs/tags/')
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Go
      uses: actions/setup-go@v3
      with:
        go-version: 1.19
    
    - name: Build release binaries
      run: make build-all
    
    - name: Create Release
      uses: actions/create-release@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        tag_name: ${{ github.ref }}
        release_name: Release ${{ github.ref }}
        draft: false
        prerelease: false
```

### 5.2 ë°°í¬ ìë™í™”

#### Ansible í”Œë ˆì´ë¶
```yaml
# ansible/deploy.yml
---
- hosts: dhcp_servers
  become: yes
  vars:
    dhcp_user: dhcp-test
    dhcp_home: /opt/dhcp-test
    dhcp_version: "{{ version | default('latest') }}"
  
  tasks:
    - name: Create dhcp user
      user:
        name: "{{ dhcp_user }}"
        system: yes
        shell: /bin/false
        home: "{{ dhcp_home }}"
        create_home: yes
    
    - name: Create directories
      file:
        path: "{{ item }}"
        state: directory
        owner: "{{ dhcp_user }}"
        group: "{{ dhcp_user }}"
        mode: '0755'
      loop:
        - "{{ dhcp_home }}/bin"
        - "{{ dhcp_home }}/config"
        - "{{ dhcp_home }}/logs"
    
    - name: Download binaries
      get_url:
        url: "https://github.com/example/dhcp-test/releases/download/{{ dhcp_version }}/dhcp-server-linux-amd64"
        dest: "{{ dhcp_home }}/bin/dhcp-server"
        owner: "{{ dhcp_user }}"
        group: "{{ dhcp_user }}"
        mode: '0755'
    
    - name: Download tester binary
      get_url:
        url: "https://github.com/example/dhcp-test/releases/download/{{ dhcp_version }}/dhcp-tester-linux-amd64"
        dest: "{{ dhcp_home }}/bin/dhcp-tester"
        owner: "{{ dhcp_user }}"
        group: "{{ dhcp_user }}"
        mode: '0755'
    
    - name: Install systemd service
      template:
        src: dhcp-server.service.j2
        dest: /etc/systemd/system/dhcp-server.service
      notify:
        - reload systemd
        - restart dhcp-server
    
    - name: Start and enable service
      systemd:
        name: dhcp-server
        state: started
        enabled: yes
        daemon_reload: yes
  
  handlers:
    - name: reload systemd
      systemd:
        daemon_reload: yes
    
    - name: restart dhcp-server
      systemd:
        name: dhcp-server
        state: restarted
```

### 5.3 ëª¨ë‹ˆí„°ë§ ìŠ¤í¬ë¦½íŠ¸

#### í—¬ìŠ¤ì²´í¬ ìŠ¤í¬ë¦½íŠ¸
```bash
#!/bin/bash
# scripts/health-check.sh

# ì„¤ì •
DHCP_SERVER="127.0.0.1"
DHCP_PORT="67"
LOG_FILE="/var/log/dhcp-test/health-check.log"
ALERT_THRESHOLD=90  # ì‹¤íŒ¨ìœ¨ 90% ì´ìƒ ì‹œ ì•Œë¦¼

# ë¡œê·¸ í•¨ìˆ˜
log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a "$LOG_FILE"
}

# í—¬ìŠ¤ì²´í¬ í•¨ìˆ˜
health_check() {
    local test_name="$1"
    local clients="$2"
    local expected_success_rate="$3"
    
    log "í—¬ìŠ¤ì²´í¬ ì‹œì‘: $test_name ($clients í´ë¼ì´ì–¸íŠ¸)"
    
    # ì„ì‹œ ê²°ê³¼ íŒŒì¼
    local result_file="/tmp/dhcp-health-check-$$.log"
    
    # í…ŒìŠ¤íŠ¸ ì‹¤í–‰
    timeout 60s ./dhcp-tester \
        -server "$DHCP_SERVER" \
        -port "$DHCP_PORT" \
        -clients "$clients" \
        -concurrency 10 \
        -timeout 10s \
        -progress > "$result_file" 2>&1
    
    local exit_code=$?
    
    if [ $exit_code -eq 0 ]; then
        # ì„±ê³µë¥  ì¶”ì¶œ
        local success_rate=$(grep "ì„±ê³µë¥ :" "$result_file" | awk '{print $2}' | sed 's/%//')
        
        if [ -n "$success_rate" ]; then
            local success_rate_int=${success_rate%.*}  # ì†Œìˆ˜ì  ì œê±°
            
            if [ "$success_rate_int" -ge "$expected_success_rate" ]; then
                log "âœ… $test_name ì„±ê³µ: ì„±ê³µë¥  ${success_rate}%"
                echo "PASS"
            else
                log "âš ï¸ $test_name ì„±ê³µë¥  ë¶€ì¡±: ${success_rate}% (ê¸°ëŒ€: ${expected_success_rate}%)"
                echo "WARN"
            fi
        else
            log "âŒ $test_name ê²°ê³¼ íŒŒì‹± ì‹¤íŒ¨"
            echo "FAIL"
        fi
    else
        log "âŒ $test_name ì‹¤í–‰ ì‹¤íŒ¨ (ì¢…ë£Œ ì½”ë“œ: $exit_code)"
        echo "FAIL"
    fi
    
    rm -f "$result_file"
}

# ì•Œë¦¼ ë°œì†¡ í•¨ìˆ˜
send_alert() {
    local message="$1"
    
    # ì´ë©”ì¼ ì•Œë¦¼ (ì„ íƒì )
    if command -v mail &> /dev/null; then
        echo "$message" | mail -s "DHCP í—¬ìŠ¤ì²´í¬ ì•Œë¦¼" admin@example.com
    fi
    
    # ìŠ¬ë™ ì•Œë¦¼ (ì„ íƒì )
    if [ -n "$SLACK_WEBHOOK" ]; then
        curl -X POST -H 'Content-type: application/json' \
            --data "{\"text\":\"$message\"}" \
            "$SLACK_WEBHOOK"
    fi
    
    log "ì•Œë¦¼ ë°œì†¡: $message"
}

# ë©”ì¸ í—¬ìŠ¤ì²´í¬ ë¡œì§
main() {
    log "=== DHCP í—¬ìŠ¤ì²´í¬ ì‹œì‘ ==="
    
    # ì„œë²„ ì—°ê²° í™•ì¸
    if ! nc -z -u "$DHCP_SERVER" "$DHCP_PORT" 2>/dev/null; then
        local alert_msg="âŒ DHCP ì„œë²„ ì—°ê²° ì‹¤íŒ¨: $DHCP_SERVER:$DHCP_PORT"
        log "$alert_msg"
        send_alert "$alert_msg"
        exit 1
    fi
    
    # ë‹¨ê³„ë³„ í—¬ìŠ¤ì²´í¬
    local results=()
    
    results+=($(health_check "ê¸°ë³¸_í…ŒìŠ¤íŠ¸" 10 95))
    results+=($(health_check "ì¤‘ê°„_ë¶€í•˜" 100 90))
    results+=($(health_check "ë†’ì€_ë¶€í•˜" 500 85))
    
    # ê²°ê³¼ ë¶„ì„
    local pass_count=0
    local warn_count=0
    local fail_count=0
    
    for result in "${results[@]}"; do
        case $result in
            "PASS") ((pass_count++)) ;;
            "WARN") ((warn_count++)) ;;
            "FAIL") ((fail_count++)) ;;
        esac
    done
    
    local total_tests=${#results[@]}
    local fail_rate=$((fail_count * 100 / total_tests))
    
    log "í—¬ìŠ¤ì²´í¬ ì™„ë£Œ: PASS=$pass_count, WARN=$warn_count, FAIL=$fail_count"
    
    # ì•Œë¦¼ ì¡°ê±´ í™•ì¸
    if [ $fail_rate -ge $ALERT_THRESHOLD ]; then
        local alert_msg="ğŸš¨ DHCP ì„œë²„ ìƒíƒœ ìœ„í—˜: ì‹¤íŒ¨ìœ¨ ${fail_rate}% (${fail_count}/${total_tests})"
        send_alert "$alert_msg"
        exit 1
    elif [ $warn_count -gt 0 ]; then
        log "âš ï¸ ì¼ë¶€ í…ŒìŠ¤íŠ¸ì—ì„œ ì„±ëŠ¥ ì €í•˜ ê°ì§€ë¨"
    fi
    
    log "=== í—¬ìŠ¤ì²´í¬ ì™„ë£Œ ==="
}

# ì‹¤í–‰
main "$@"
```

## 6. ì»¨í…Œì´ë„ˆ ë°°í¬

### 6.1 Docker ì´ë¯¸ì§€

#### Dockerfile
```dockerfile
# Dockerfile
FROM golang:1.19-alpine AS builder

# ë¹Œë“œ ì˜ì¡´ì„± ì„¤ì¹˜
RUN apk add --no-cache git make

# ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# ì†ŒìŠ¤ì½”ë“œ ë³µì‚¬
COPY . .

# ë¹Œë“œ
RUN make build

# ëŸ°íƒ€ì„ ì´ë¯¸ì§€
FROM alpine:latest

# ëŸ°íƒ€ì„ ì˜ì¡´ì„± ì„¤ì¹˜
RUN apk add --no-cache ca-certificates tzdata \
    && adduser -D -s /bin/sh dhcp-test

# ë°”ì´ë„ˆë¦¬ ë³µì‚¬
COPY --from=builder /app/dhcp-tester /usr/local/bin/
COPY --from=builder /app/dhcp-server /usr/local/bin/

# ì‚¬ìš©ì ë³€ê²½
USER dhcp-test

# í¬íŠ¸ ë…¸ì¶œ
EXPOSE 67/udp 68/udp

# ê¸°ë³¸ ëª…ë ¹ì–´
CMD ["dhcp-server"]
```

#### Docker Compose
```yaml
# docker-compose.yml
version: '3.8'

services:
  dhcp-server:
    build: .
    container_name: dhcp-server
    ports:
      - "67:67/udp"
      - "68:68/udp"
    environment:
      - DHCP_START_IP=192.168.100.10
      - DHCP_END_IP=192.168.100.250
      - DHCP_GATEWAY=192.168.100.1
    command: >
      dhcp-server 
      -start-ip ${DHCP_START_IP}
      -end-ip ${DHCP_END_IP}
      -gateway ${DHCP_GATEWAY}
      -live
    volumes:
      - ./logs:/var/log/dhcp-test
    restart: unless-stopped
    networks:
      - dhcp-net

  dhcp-tester:
    build: .
    container_name: dhcp-tester
    depends_on:
      - dhcp-server
    environment:
      - DHCP_SERVER=dhcp-server
      - DHCP_CLIENTS=1000
    command: >
      dhcp-tester
      -server ${DHCP_SERVER}
      -clients ${DHCP_CLIENTS}
      -concurrency 100
      -retry
      -live
    volumes:
      - ./results:/var/log/dhcp-test
    networks:
      - dhcp-net
    profiles:
      - test

networks:
  dhcp-net:
    driver: bridge
```

### 6.2 Kubernetes ë°°í¬

#### Deployment ë§¤ë‹ˆí˜ìŠ¤íŠ¸
```yaml
# k8s/dhcp-server-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: dhcp-server
  labels:
    app: dhcp-server
spec:
  replicas: 1
  selector:
    matchLabels:
      app: dhcp-server
  template:
    metadata:
      labels:
        app: dhcp-server
    spec:
      containers:
      - name: dhcp-server
        image: dhcp-test:latest
        command: ["dhcp-server"]
        args:
          - "-start-ip=10.42.0.10"
          - "-end-ip=10.42.0.250"
          - "-gateway=10.42.0.1"
          - "-live"
        ports:
        - containerPort: 67
          protocol: UDP
        - containerPort: 68
          protocol: UDP
        env:
        - name: DHCP_LOG_LEVEL
          value: "info"
        resources:
          requests:
            memory: "512Mi"
            cpu: "500m"
          limits:
            memory: "2Gi"
            cpu: "2000m"
        livenessProbe:
          exec:
            command:
            - /bin/sh
            - -c
            - "nc -z -u localhost 67"
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          exec:
            command:
            - /bin/sh
            - -c
            - "nc -z -u localhost 67"
          initialDelaySeconds: 5
          periodSeconds: 5

---
apiVersion: v1
kind: Service
metadata:
  name: dhcp-server-service
spec:
  selector:
    app: dhcp-server
  ports:
  - name: dhcp-server
    port: 67
    targetPort: 67
    protocol: UDP
  - name: dhcp-client
    port: 68
    targetPort: 68
    protocol: UDP
  type: LoadBalancer
```

#### Job ë§¤ë‹ˆí˜ìŠ¤íŠ¸ (í…ŒìŠ¤í„°ìš©)
```yaml
# k8s/dhcp-tester-job.yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: dhcp-tester
spec:
  template:
    spec:
      containers:
      - name: dhcp-tester
        image: dhcp-test:latest
        command: ["dhcp-tester"]
        args:
          - "-server=dhcp-server-service"
          - "-clients=1000"
          - "-concurrency=100"
          - "-retry"
          - "-timeout=30s"
        env:
        - name: DHCP_LOG_LEVEL
          value: "info"
        resources:
          requests:
            memory: "1Gi"
            cpu: "1000m"
          limits:
            memory: "4Gi"
            cpu: "4000m"
      restartPolicy: Never
  backoffLimit: 3
```

## 7. ëª¨ë‹ˆí„°ë§ ì„¤ì •

### 7.1 ë©”íŠ¸ë¦­ ìˆ˜ì§‘

#### Prometheus ë©”íŠ¸ë¦­ ë…¸ì¶œ
```go
// metrics.go ì˜ˆì‹œ
package main

import (
    "net/http"
    "github.com/prometheus/client_golang/prometheus"
    "github.com/prometheus/client_golang/prometheus/promhttp"
)

var (
    dhcpRequestsTotal = prometheus.NewCounterVec(
        prometheus.CounterOpts{
            Name: "dhcp_requests_total",
            Help: "Total number of DHCP requests",
        },
        []string{"type", "status"},
    )
    
    dhcpResponseTime = prometheus.NewHistogramVec(
        prometheus.HistogramOpts{
            Name: "dhcp_response_time_seconds",
            Help: "DHCP response time in seconds",
        },
        []string{"type"},
    )
)

func init() {
    prometheus.MustRegister(dhcpRequestsTotal)
    prometheus.MustRegister(dhcpResponseTime)
}

func startMetricsServer() {
    http.Handle("/metrics", promhttp.Handler())
    http.ListenAndServe(":8080", nil)
}
```

### 7.2 Grafana ëŒ€ì‹œë³´ë“œ

#### ëŒ€ì‹œë³´ë“œ JSON
```json
{
  "dashboard": {
    "title": "DHCP Performance Test Dashboard",
    "panels": [
      {
        "title": "DHCP Request Rate",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(dhcp_requests_total[5m])",
            "legendFormat": "{{type}} - {{status}}"
          }
        ]
      },
      {
        "title": "Response Time Distribution",
        "type": "heatmap",
        "targets": [
          {
            "expr": "dhcp_response_time_seconds_bucket",
            "legendFormat": "{{le}}"
          }
        ]
      }
    ]
  }
}
```

---

ì´ ì„¤ì¹˜ ë° ë°°í¬ ê°€ì´ë“œë¥¼ í†µí•´ ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ DHCP ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì†”ë£¨ì…˜ì„ íš¨ìœ¨ì ìœ¼ë¡œ ë°°í¬í•˜ê³  ìš´ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.